import{d as E,L,a6 as R,r as f,c as U,w as l,u as t,I as W,a as o,N as C,Q as I,R as $,a2 as j,O as q,f as w,M as z,b as u,a3 as b,a4 as M,g as k,a5 as Y,e as Q,h as A,o as F}from"./index-DaBKy6N1.js";import{d as s}from"./dayjs.min-CxMP4GVf.js";import{u as G,o as m,h as D,d as y,l as J,k as K,f as X,_ as Z}from"./_plugin-vue_export-helper-C2CsQJ2I.js";const ee={class:"ion-padding"},ae={class:"ion-margin-bottom"},te={class:"ion-margin-top"},oe={class:"ion-margin-bottom"},ne={class:"ion-margin-top"},le={class:"ion-margin-bottom"},se=E({__name:"EditTodoPage",setup(ie){const B=A(),T=R(),p=G(),a=f({id:"",date:"",time:"",content:"",check:!1}),d=f(""),r=f(""),g=f(""),_=f(""),N=async(i,e)=>{const n=p.uid;if(!n){m("請先登入","danger");return}try{const c=D(y,"todoList",n,i,e),v=await J(c);v.exists()?(a.value.date=v.data().date,a.value.time=v.data().time,a.value.content=v.data().content,a.value.iso8601=v.data().iso8601):m("資料不存在","danger")}catch(c){m(c,"danger")}},O=async(i,e)=>{const n=p.uid;if(!n){m("請先登入","danger");return}try{await X(D(y,"todoList",n,i,e))}catch(c){console.error("Error getting documents:",c)}},V=async()=>{const i="".concat(a.value.date).concat(a.value.time),e=s(i).valueOf().toString(),n=p.uid;if(!n){m("請先登入","danger");return}await O(g.value,_.value);try{await K(D(y,"todoList",n,a.value.date,e),{id:e,date:a.value.date,time:a.value.time,content:a.value.content,iso8601:a.value.iso8601,check:!1}),m("新增成功","success"),h()}catch(c){m(c,"danger")}},x=()=>{d.value?d.value=s(d.value).format():d.value=s(a.value.iso8601).format(),a.value.date=s(d.value).format("YYYY-MM-DD")},S=()=>{r.value?r.value=s(r.value).format():r.value=s(a.value.iso8601).format(),a.value.time=s(r.value).format("HH:mm")},H=i=>{const e=i.detail.value;e&&(d.value=s(e).format(),a.value.date=s(e).format("YYYY-MM-DD"))},P=i=>{const e=i.detail.value;e&&(r.value=s(e).format(),a.value.time=s(e).format("HH:mm"))},h=()=>{B.push({name:"home"})};return L(()=>{g.value=T.query.date,_.value=T.params.id,N(g.value,_.value)}),(i,e)=>(F(),U(t(W),null,{default:l(()=>[o(t(z),{class:"ion-no-border"},{default:l(()=>[o(t(C),null,{default:l(()=>[o(t(I),{slot:"start",class:"icon_area",onClick:h},{default:l(()=>[o(t($),{class:"icon_area_img","aria-hidden":"true",size:"large",icon:t(j)},null,8,["icon"])]),_:1}),o(t(q),{class:"page_title"},{default:l(()=>[...e[3]||(e[3]=[w("編輯項目",-1)])]),_:1}),o(t(I),{slot:"end",class:"icon_area"})]),_:1})]),_:1}),o(t(k),{fullscreen:!0},{default:l(()=>[u("div",ee,[u("div",ae,[e[4]||(e[4]=u("div",{class:"input_title"},"日期",-1)),o(t(b),{value:a.value.date,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.date=n),"label-placement":"floating",fill:"outline",id:"open-date-modal"},null,8,["value"]),o(t(M),{trigger:"open-date-modal","initial-breakpoint":.4,breakpoints:[.4],"handle-behavior":"cycle",onWillPresent:x},{default:l(()=>[o(t(k),{class:"ion-padding"},{default:l(()=>[u("div",te,[o(t(Y),{presentation:"date",value:d.value,onIonChange:H},null,8,["value"])])]),_:1})]),_:1})]),u("div",oe,[e[5]||(e[5]=u("div",{class:"input_title"},"時間",-1)),o(t(b),{value:a.value.time,"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.time=n),"label-placement":"floating",fill:"outline",id:"open-time-modal"},null,8,["value"]),o(t(M),{trigger:"open-time-modal","initial-breakpoint":.3,breakpoints:[.3],"handle-behavior":"cycle",onWillPresent:S},{default:l(()=>[o(t(k),{class:"ion-padding"},{default:l(()=>[u("div",ne,[o(t(Y),{presentation:"time",value:r.value,onIonChange:P},null,8,["value"])])]),_:1})]),_:1})]),u("div",le,[e[6]||(e[6]=u("div",{class:"input_title"},"內容",-1)),o(t(b),{value:a.value.content,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.content=n),"label-placement":"floating",fill:"outline"},null,8,["value"])]),o(t(C),null,{default:l(()=>[o(t(I),{slot:"primary"},{default:l(()=>[o(t(Q),{fill:"solid",onClick:V},{default:l(()=>[...e[7]||(e[7]=[w("更新",-1)])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}))}}),ce=Z(se,[["__scopeId","data-v-e0b7c433"]]);export{ce as default};
