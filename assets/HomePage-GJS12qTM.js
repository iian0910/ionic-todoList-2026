import{d as L,x as O,r as v,m as D,e as l,F as B,y as P,k as r,z as V,t as g,_ as M,u as j,A as R,o as _,c as m,w as c,a,I as U,B as H,C as A,D as S,E,b as i,G as k,H as F,J as b,K as q,p as Y,f as h,L as K,M as W,N as G,O as J,P as Q,Q as X,R as Z,S as ee,T as te,U as ae,V as se,W as ne,X as oe,g as ce,Y as ie,Z as N,j as le,$ as re,h as de}from"./index-TM_tSvUV.js";import{d as $}from"./dayjs.min-CxMP4GVf.js";import{s as ue,a as _e}from"./vue-virtual-scroller.esm-B2zRwTCa.js";const pe={class:"picker-wrapper"},me=["onClick"],ye={class:"weekday"},fe={class:"day"},he={class:"month"},ge=L({__name:"DatePicker",emits:["selectedDate"],setup(z,{emit:w}){const f=w,p=v(null),u=v(new Date),y=v([]),C=["日","一","二","三","四","五","六"],x=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],T=()=>{const e=[],o=new Date;for(let s=-15;s<=15;s++){const d=new Date(o);d.setDate(o.getDate()+s),e.push({date:new Date(d),day:d.getDate(),month:x[d.getMonth()],weekday:C[d.getDay()],timestamp:d.getTime()})}y.value=e},I=e=>{u.value=new Date(e.date),f("selectedDate",$(u.value).format("YYYY/MM/DD"))},t=e=>e.date.toDateString()===u.value.toDateString(),n=e=>{const o=new Date;return e.date.toDateString()===o.toDateString()};return O(()=>{T(),setTimeout(()=>{if(p.value){const e=p.value.querySelector(".selected");e&&e.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}},100)}),(e,o)=>(r(),D("div",pe,[l("div",{class:"dates-container",ref_key:"datesContainer",ref:p},[(r(!0),D(B,null,P(y.value,s=>(r(),D("div",{key:s.timestamp,class:V(["date-item",{selected:t(s),today:n(s)}]),onClick:d=>I(s)},[l("div",ye,g(s.weekday),1),l("div",fe,g(s.day),1),l("div",he,g(s.month),1)],10,me))),128))],512)]))}}),ve=M(ge,[["__scopeId","data-v-7ef44356"]]),ke={class:"ion-display-flex ion-justify-content-between ion-align-items-center"},De={class:"ion-display-flex ion-align-items-center ion-padding-horizontal"},we=["src"],Ce={class:"card-wrapper"},xe={class:"ion-display-flex ion-align-items-center"},Te={class:"ion-display-flex ion-justify-content-between ion-align-items-center"},Ie={class:"ion-display-flex ion-justify-content-end"},Se={key:1,class:"ion-display-flex ion-flex-column ion-justify-content-center ion-align-items-center no_data"},Ye=L({__name:"HomePage",setup(z){const w=le(),f=j(),p=v([]),u=v(null),y=async t=>{const n=$(t).format("YYYY-MM-DD"),e=f.uid;if(!e){_("請先登入","danger");return}try{const o=await H(A(S,"todoList",e,n));o.empty?p.value=[]:p.value=o.docs.map(s=>({id:s.data().id,date:s.data().date,time:s.data().time,content:s.data().content,check:s.data().check}))}catch(o){_(o,"danger")}},C=async t=>{const n=f.uid;if(!n){_("請先登入","danger");return}try{await ie(N(S,"todoList",n,t.date,t.id)),_("刪除成功","success")}catch(e){_(e,"danger")}y(t.date)},x=(t,n)=>{w.push({name:"editTodo",params:{id:n},query:{date:t}})},T=async t=>{const n=f.uid;if(!n){_("請先登入","danger");return}const e=N(S,"todoList",n,t.date,t.id);try{await re(e,{check:!0}),_("更新成功","success")}catch(o){_(o,"danger")}y(t.date)},I=()=>new Promise(t=>{const n=E(de,e=>{n(),t(e)})});return R(async()=>{const t=await I();u.value={uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,displayName:t==null?void 0:t.displayName,photoURL:t==null?void 0:t.photoURL},f.saveUserInfo(u.value),t?y($(new Date).format("YYYY-MM-DD")):_("使用者未登入","danger")}),(t,n)=>(r(),m(a(U),null,{default:c(()=>[i(a(G),{class:"ion-no-border"},{default:c(()=>{var e;return[i(a(F),{class:"ion-toolbar"},{default:c(()=>[l("div",ke,[i(a(b),{slot:"start"},{default:c(()=>[i(a(q),{class:"ion-padding-horizontal"},{default:c(()=>[...n[0]||(n[0]=[Y("TODOLIST",-1)])]),_:1})]),_:1}),l("div",De,[i(a(b),{slot:"end",class:"icon_area"},{default:c(()=>{var o;return[(o=u.value)!=null&&o.uid?(r(),m(a(W),{key:1},{default:c(()=>{var s;return[l("img",{class:"user-photo",src:(s=u.value)==null?void 0:s.photoURL,alt:"用戶頭像",referrerpolicy:"no-referrer"},null,8,we)]}),_:1})):(r(),m(a(h),{key:0,class:"icon_area_img","aria-hidden":"true",size:"large",icon:a(K)},null,8,["icon"]))]}),_:1})])])]),_:1}),(e=u.value)!=null&&e.uid?(r(),m(ve,{key:0,onSelectedDate:y})):k("",!0)]}),_:1}),i(a(ce),{fullscreen:!0,class:"page-content"},{default:c(()=>[p.value.length?(r(),m(a(ue),{key:0,class:"scroller",items:p.value,"min-item-size":200},{default:c(({item:e,index:o,active:s})=>[i(a(_e),{item:e,active:s,"size-dependencies":[e.content],"data-index":o},{default:c(()=>[l("div",Ce,[i(a(J),{class:"ion-padding"},{default:c(()=>[i(a(Q),{class:"ion-no-padding ion-padding-vertical"},{default:c(()=>[l("div",xe,[i(a(X),null,{default:c(()=>[Y(g(e.content),1)]),_:2},1024),e.check?(r(),m(a(h),{key:0,class:"pl-2",color:"primary",icon:a(Z)},null,8,["icon"])):k("",!0)])]),_:2},1024),i(a(ee),{class:"ion-no-padding"},{default:c(()=>[l("div",Te,[l("div",null,[i(a(te),null,{default:c(()=>[Y(g(e.date)+" "+g(e.time),1)]),_:2},1024)]),l("div",Ie,[e.check?k("",!0):(r(),m(a(h),{key:0,color:"primary",icon:a(ae),onClick:d=>x(e.date,e.id)},null,8,["icon","onClick"])),e.check?k("",!0):(r(),m(a(h),{key:1,color:"success",icon:a(se),onClick:d=>T(e)},null,8,["icon","onClick"])),i(a(h),{color:"danger",icon:a(ne),onClick:d=>C(e)},null,8,["icon","onClick"])])])]),_:2},1024)]),_:2},1024)])]),_:2},1032,["item","active","size-dependencies","data-index"])]),_:1},8,["items"])):(r(),D("div",Se,[i(a(h),{icon:a(oe),class:"empty_status"},null,8,["icon"]),n[1]||(n[1]=l("div",{class:"empty_title"},"目前尚無資料...",-1))]))]),_:1})]),_:1}))}}),Le=M(Ye,[["__scopeId","data-v-df9e4f18"]]);export{Le as default};
